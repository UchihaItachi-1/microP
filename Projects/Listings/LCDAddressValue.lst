A51 MACRO ASSEMBLER  LCDADDRESSVALUE                                                      09/24/2019 16:27:56 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN .\Objects\LCDAddressValue.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE ..\Codes\LCDAddressValue.asm SET(SMALL) DEBUG PRINT(.\Listings\LCDAddre
                      ssValue.lst) OBJECT(.\Objects\LCDAddressValue.obj) EP

LOC  OBJ            LINE     SOURCE

  0080                 1     LCD_rs   equ P0.0
  0081                 2     LCD_rw   equ P0.1
  0082                 3     LCD_en   equ P0.2
  00A0                 4     LCD_data equ P2
                       5     
0000                   6     org      0000h
0000 020148            7     ljmp main
                       8     
0050                   9     org  0050h
0050 380C0106         10     initSeq:db 0x38, 0x0C, 0x01, 0x06
0054 30313233         11     ascii:  db 0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x41, 0x42, 0x43, 0x
                             44, 0x45, 0x46
0058 34353637                
005C 38394142                
0060 43444546                
                      12     
0064                  13     bin2ascii:
0064 900054           14                     mov  dptr, #ascii
0067 FD               15                     mov  R5, A
0068 54F0             16                     anl  A,  #0xF0
006A C4               17                     swap A
006B 93               18                     movc A, @A+dptr
006C F7               19                     mov @R1, A
006D 09               20                     inc  R1
006E ED               21                     mov  A,  R5
006F 540F             22                     anl  A,  #0x0F
0071 93               23                     movc A, @A+dptr
0072 F7               24                     mov @R1, A
0073 09               25                     inc  R1
0074 77FF             26                     mov @R1, #0xFF
0076 22               27     ret
                      28     
0077 7821             29     rand:   mov  R0, #0x21
0079 761E             30                     mov @R0, #0x1E  ;21
007B 08               31                     inc  R0
007C 762D             32                     mov @R0, #0x2D  ;22
007E 08               33                     inc  R0
007F 763C             34                     mov @R0, #0x3C  ;23
0081 08               35                     inc  R0
0082 764B             36                     mov @R0, #0x4B  ;24
0084 08               37                     inc  R0
0085 765A             38                     mov @R0, #0x5A  ;25
0087 08               39                     inc  R0
0088 7669             40                     mov @R0, #0x69  ;26
008A 08               41                     inc  R0
008B 7678             42                     mov @R0, #0x78  ;27
008D 08               43                     inc  R0
008E 7687             44                     mov @R0, #0x87  ;28
0090 08               45                     inc  R0
0091 7696             46                     mov @R0, #0x96  ;29
0093 08               47                     inc  R0
0094 76A5             48                     mov @R0, #0xA5  ;2A
0096 08               49                     inc  R0
0097 76B4             50                     mov @R0, #0xB4  ;2B
0099 08               51                     inc  R0
009A 76C3             52                     mov @R0, #0xC3  ;2C
009C 08               53                     inc  R0
A51 MACRO ASSEMBLER  LCDADDRESSVALUE                                                      09/24/2019 16:27:56 PAGE     2

009D 76D2             54                     mov @R0, #0xD2  ;2D
009F 08               55                     inc  R0
00A0 76E1             56                     mov @R0, #0xE1  ;2E
00A2 08               57                     inc  R0
00A3 76F0             58                     mov @R0, #0xF0  ;2F
00A5 08               59                     inc  R0
00A6 769E             60                     mov @R0, #0x9E  ;30
00A8 08               61                     inc  R0
00A9 760F             62                     mov @R0, #0x0F  ;31
00AB 08               63                     inc  R0
00AC 76F8             64                     mov @R0, #0xF8  ;32
00AE 08               65                     inc  R0
00AF 7687             66                     mov @R0, #0x87  ;33
00B1 08               67                     inc  R0
00B2 76E2             68                     mov @R0, #0xE2  ;34
00B4 08               69                     inc  R0
00B5 767D             70                     mov @R0, #0x7D  ;35
00B7 08               71                     inc  R0
00B8 76C9             72                     mov @R0, #0xC9  ;36
00BA 08               73                     inc  R0
00BB 7614             74                     mov @R0, #0x14  ;37
00BD 08               75                     inc  R0
00BE 76D6             76                     mov @R0, #0xD6  ;38
00C0 08               77                     inc  R0
00C1 7633             78                     mov @R0, #0x33  ;39
00C3 08               79                     inc  R0
00C4 76B5             80                     mov @R0, #0xB5  ;3A
00C6 08               81                     inc  R0
00C7 762C             82                     mov @R0, #0x2C  ;3B
00C9 08               83                     inc  R0
00CA 76A1             84                     mov @R0, #0xA1  ;3C
00CC 08               85                     inc  R0
00CD 766D             86                     mov @R0, #0x6D  ;3D
00CF 08               87                     inc  R0
00D0 765B             88                     mov @R0, #0x5B  ;3E
00D2 08               89                     inc  R0
00D3 7640             90                     mov @R0, #0x40  ;3F
00D5 22               91     ret
                      92     
00D6 7841             93     desc:   mov  R0, #0x41
00D8 764C             94                     mov @R0, #0x4C  ;41
00DA 08               95                     inc  R0
00DB 766F             96                     mov @R0, #0x6F  ;42
00DD 08               97                     inc  R0
00DE 7663             98                     mov @R0, #0x63  ;43
00E0 08               99                     inc  R0
00E1 7661            100                     mov @R0, #0x61  ;44
00E3 08              101                     inc  R0
00E4 7674            102                     mov @R0, #0x74  ;45
00E6 08              103                     inc  R0
00E7 7669            104                     mov @R0, #0x69  ;46
00E9 08              105                     inc  R0
00EA 766F            106                     mov @R0, #0x6F  ;47
00EC 08              107                     inc  R0
00ED 766E            108                     mov @R0, #0x6E  ;48
00EF 08              109                     inc  R0
00F0 763A            110                     mov @R0, #0x3A  ;49
00F2 08              111                     inc  R0
00F3 7620            112                     mov @R0, #0x20  ;4A
00F5 08              113                     inc  R0
00F6 08              114                     inc  R0
00F7 08              115                     inc  R0
00F8 76FF            116                     mov @R0, #0xFF  ;4D
                     117                     
00FA 08              118                     inc  R0
00FB 7643            119                     mov @R0, #0x43  ;4E
A51 MACRO ASSEMBLER  LCDADDRESSVALUE                                                      09/24/2019 16:27:56 PAGE     3

00FD 08              120                     inc  R0
00FE 766F            121                     mov @R0, #0x6F  ;4F
0100 08              122                     inc  R0
0101 766E            123                     mov @R0, #0x6E  ;50
0103 08              124                     inc  R0
0104 7674            125                     mov @R0, #0x74  ;51
0106 08              126                     inc  R0
0107 7665            127                     mov @R0, #0x65  ;52
0109 08              128                     inc  R0
010A 766E            129                     mov @R0, #0x6E  ;53
010C 08              130                     inc  R0
010D 7674            131                     mov @R0, #0x74  ;54
010F 08              132                     inc  R0
0110 7673            133                     mov @R0, #0x73  ;55
0112 08              134                     inc  R0
0113 763A            135                     mov @R0, #0x3A  ;56
0115 08              136                     inc  R0
0116 7620            137                     mov @R0, #0x20  ;57
0118 08              138                     inc  R0
0119 08              139                     inc  R0
011A 08              140                     inc  R0
011B 76FF            141                     mov @R0, #0xFF  ;60
011D 22              142     ret
                     143     
011E                 144     readNibbles:
011E 7590FF          145                     mov P1,  #0xFF
0121 1201EB          146                     lcall delayThree
0124 53900F          147                     anl P1,  #0x0F
0127 120200          148                     lcall delay
012A E590            149                     mov  A,   P1
012C F58B            150                     mov  TL1, A
012E C4              151                     swap A
012F F590            152                     mov  P1, A
0131 31F5            153                     acall delayOne
0133 22              154     ret
                     155     
0134                 156     packNibbles:
0134 E561            157                     mov  A,    0x61
0136 C4              158                     swap A
0137 54F0            159                     anl  A,   #0xF0
0139 F8              160                     mov  R0,   A
013A E562            161                     mov  A,    0x62
013C 540F            162                     anl  A,   #0x0F
013E 28              163                     add  A,    R0
013F F8              164                     mov  R0,   A
0140 F560            165                     mov  0x60, A
0142 7563FF          166                     mov  0x63, #0xFF                
0145 1164            167                     acall bin2ascii
0147 22              168     ret
                     169     
0148 75A000          170     main:   mov P2, #0x00
014B 759000          171                     mov P1, #0x00
014E 7B00            172                     mov R3, #0x00
0150 11D6            173                     acall desc
0152 5100            174                     acall delay
0154 5100            175                     acall delay
                     176                     
0156 31A0            177                     acall lcd_init
0158 5100            178     repeat: acall delay
015A 5100            179                     acall delay
015C 5100            180                     acall delay
                     181                     
015E 12011E          182                     lcall readNibbles
0161 858B61          183                     mov   0x61,  TL1
0164 12011E          184                     lcall readNibbles
0167 858B62          185                     mov   0x62,  TL1
A51 MACRO ASSEMBLER  LCDADDRESSVALUE                                                      09/24/2019 16:27:56 PAGE     4

016A 794B            186                     mov  R1,  #0x4B
016C 120134          187                     lcall packNibbles
                     188                     
016F 1177            189                     acall rand
0171 A860            190                     mov  R0,   0x60
0173 E6              191                     mov  A,   @R0
0174 54F0            192                     anl  A,   #0xF0
0176 C4              193                     swap A
0177 F561            194                     mov  0x61, A
0179 E6              195                     mov  A,   @R0
017A 540F            196                     anl  A,   #0x0F
017C F562            197                     mov  0x62, A
017E 7958            198                     mov  R1,  #0x58
0180 120134          199                     lcall packNibbles
                     200                     
0183 7480            201                     mov   A,  #0x80
0185 31BA            202                     acall lcd_command
0187 5100            203                     acall delay
0189 7941            204                     mov   R1, #0x41
018B 31DA            205                     acall lcd_sendstring
018D 5100            206                     acall delay
                     207     
018F 74C0            208                     mov   A,  #0xC0
0191 31BA            209                     acall lcd_command
0193 5100            210                     acall delay
0195 794E            211                     mov   R1, #0x4E
0197 31DA            212                     acall lcd_sendstring
0199 5100            213                     acall delay
                     214                     
019B 31EB            215                     acall delayThree
019D 020158          216                     ljmp  repeat
                     217     
01A0                 218     lcd_init:
01A0 7F00            219                     mov   R7, #0x00
01A2 900050          220                     mov   dptr, #initSeq
01A5 EF              221     CP1:    mov   A,  R7
01A6 93              222                     movc  A,  @A+dptr
01A7 0F              223                     inc   R7
01A8 F5A0            224                     mov   LCD_data, A
01AA C280            225                     clr   LCD_rs
01AC C281            226                     clr   LCD_rw
01AE D282            227                     setb  LCD_en
01B0 5100            228                     acall delay
01B2 C282            229                     clr   LCD_en
01B4 5100            230                     acall delay
01B6 BF04EC          231                     cjne  R7, #0x04, CP1
01B9 22              232     ret
                     233     
01BA                 234     lcd_command:
01BA F5A0            235                     mov   LCD_data, A
01BC C280            236                     clr   LCD_rs
01BE C281            237                     clr   LCD_rw
01C0 D282            238                     setb  LCD_en
01C2 5100            239                     acall delay
01C4 C282            240                     clr   LCD_en
01C6 5100            241                     acall delay
01C8 22              242     ret
                     243     
01C9                 244     lcd_senddata:
01C9 F5A0            245                     mov   LCD_data, A
01CB D280            246                     setb  LCD_rs
01CD C281            247                     clr   LCD_rw
01CF D282            248                     setb  LCD_en
01D1 5100            249                     acall delay
01D3 C282            250                     clr   LCD_en
01D5 5100            251                     acall delay
A51 MACRO ASSEMBLER  LCDADDRESSVALUE                                                      09/24/2019 16:27:56 PAGE     5

01D7 5100            252                     acall delay
01D9 22              253     ret
                     254     
01DA                 255     lcd_sendstring:
01DA C0E0            256                     push  0e0h
01DC                 257     lcd_sendstring_loop:
01DC E7              258                     mov   A, @R1
01DD B4FF03          259                     cjne  A, #0xFF, CP2
01E0 0201E8          260                     ljmp  exit
01E3 31C9            261     CP2:    acall lcd_senddata
01E5 09              262                     inc   R1
01E6 80F4            263                     sjmp  lcd_sendstring_loop
01E8 D0E0            264     exit:   pop   0e0h
01EA 22              265     ret
                     266     
01EB                 267     delayThree:
01EB 75F003          268                     mov  B, #0x03
01EE 1201F5          269     loop4:  lcall delayOne
01F1 D5F0FA          270                     djnz B, loop4
01F4 22              271     ret
                     272     
01F5                 273     delayOne:
01F5 7D14            274                     mov  R5,  #0x14
01F7 7EC8            275     loop3:  mov  R6,  #0xC8
01F9 5100            276     loop2:  acall delay
01FB DEFC            277                     djnz R6,   loop2
01FD DDF8            278                     djnz R5,   loop3
01FF 22              279     ret
                     280     
0200 758AFF          281     delay:  mov  TL0, #0xFF
0203 D58AFD          282     loop1:  djnz TL0,  loop1
0206 22              283     ret
                     284     
                     285     end
A51 MACRO ASSEMBLER  LCDADDRESSVALUE                                                      09/24/2019 16:27:56 PAGE     6

SYMBOL TABLE LISTING
------ ----- -------


N A M E              T Y P E  V A L U E   ATTRIBUTES

ASCII . . . . . . .  C ADDR   0054H   A   
B . . . . . . . . .  D ADDR   00F0H   A   
BIN2ASCII . . . . .  C ADDR   0064H   A   
CP1 . . . . . . . .  C ADDR   01A5H   A   
CP2 . . . . . . . .  C ADDR   01E3H   A   
DELAY . . . . . . .  C ADDR   0200H   A   
DELAYONE. . . . . .  C ADDR   01F5H   A   
DELAYTHREE. . . . .  C ADDR   01EBH   A   
DESC. . . . . . . .  C ADDR   00D6H   A   
EXIT. . . . . . . .  C ADDR   01E8H   A   
INITSEQ . . . . . .  C ADDR   0050H   A   
LCD_COMMAND . . . .  C ADDR   01BAH   A   
LCD_DATA. . . . . .  D ADDR   00A0H   A   
LCD_EN. . . . . . .  B ADDR   0080H.2 A   
LCD_INIT. . . . . .  C ADDR   01A0H   A   
LCD_RS. . . . . . .  B ADDR   0080H.0 A   
LCD_RW. . . . . . .  B ADDR   0080H.1 A   
LCD_SENDDATA. . . .  C ADDR   01C9H   A   
LCD_SENDSTRING. . .  C ADDR   01DAH   A   
LCD_SENDSTRING_LOOP  C ADDR   01DCH   A   
LOOP1 . . . . . . .  C ADDR   0203H   A   
LOOP2 . . . . . . .  C ADDR   01F9H   A   
LOOP3 . . . . . . .  C ADDR   01F7H   A   
LOOP4 . . . . . . .  C ADDR   01EEH   A   
MAIN. . . . . . . .  C ADDR   0148H   A   
P0. . . . . . . . .  D ADDR   0080H   A   
P1. . . . . . . . .  D ADDR   0090H   A   
P2. . . . . . . . .  D ADDR   00A0H   A   
PACKNIBBLES . . . .  C ADDR   0134H   A   
RAND. . . . . . . .  C ADDR   0077H   A   
READNIBBLES . . . .  C ADDR   011EH   A   
REPEAT. . . . . . .  C ADDR   0158H   A   
TL0 . . . . . . . .  D ADDR   008AH   A   
TL1 . . . . . . . .  D ADDR   008BH   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
