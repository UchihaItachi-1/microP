A51 MACRO ASSEMBLER  LCDREGISTERDISPLAY                                                   09/24/2019 17:20:02 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN .\Objects\LCDRegisterDisplay.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE ..\Codes\LCDRegisterDisplay.asm SET(SMALL) DEBUG PRINT(.\Listings\LCDRe
                      gisterDisplay.lst) OBJECT(.\Objects\LCDRegisterDisplay.obj) EP

LOC  OBJ            LINE     SOURCE

  0080                 1     LCD_rs   equ P0.0
  0081                 2     LCD_rw   equ P0.1
  0082                 3     LCD_en   equ P0.2
  00A0                 4     LCD_data equ P2
                       5     
0000                   6     org      0000h
0000 02014C            7     ljmp main
                       8     
0050                   9     org  0050h
0050 380C0106         10     initSeq:db 0x38, 0x0C, 0x01, 0x06
0054 30313233         11     ascii:  db 0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x41, 0x42, 0x43, 0x
                             44, 0x45, 0x46
0058 34353637                
005C 38394142                
0060 43444546                
0064 41505E6C         12     text:   db 0x41, 0x50, 0x5E, 0x6C, 0x00
0068 00                      
                      13     
0069                  14     bin2ascii:                                                              ;MODIFY DPTR, A, R1
                             , R2, R5
0069 900054           15                     mov  dptr, #ascii
006C 7A00             16                     mov  R2, #0x00
006E E6               17     CP3:    mov  A, @R0
006F FD               18                     mov  R5, A
0070 54F0             19                     anl  A, #0xF0
0072 C4               20                     swap A
0073 93               21                     movc A, @A+dptr
0074 F7               22                     mov @R1, A
0075 09               23                     inc  R1
0076 ED               24                     mov  A,  R5
0077 540F             25                     anl  A, #0x0F
0079 93               26                     movc A, @A+dptr
007A F7               27                     mov @R1, A
007B 08               28                     inc  R0
007C 09               29                     inc  R1
007D 0A               30                     inc  R2
007E BA03ED           31                     cjne R2, #0x03, CP3
0081 22               32     ret
                      33     
0082 7841             34     desc:   mov  R0, #0x41                                  ;MODIFY: R0, 0x41 to 0x77
0084 7641             35                     mov @R0, #0x41  ;41
0086 08               36                     inc  R0
0087 7642             37                     mov @R0, #0x42  ;42
0089 08               38                     inc  R0
008A 7650             39                     mov @R0, #0x50  ;43
008C 08               40                     inc  R0
008D 7653             41                     mov @R0, #0x53  ;44
008F 08               42                     inc  R0
0090 7657             43                     mov @R0, #0x57  ;45
0092 08               44                     inc  R0
0093 7620             45                     mov @R0, #0x20  ;46
0095 08               46                     inc  R0
0096 763D             47                     mov @R0, #0x3D  ;47
0098 08               48                     inc  R0
0099 7620             49                     mov @R0, #0x20  ;48
009B 08               50                     inc  R0
009C 08               51                     inc  R0
A51 MACRO ASSEMBLER  LCDREGISTERDISPLAY                                                   09/24/2019 17:20:02 PAGE     2

009D 08               52                     inc  R0
009E 08               53                     inc  R0
009F 08               54                     inc  R0
00A0 08               55                     inc  R0
00A1 08               56                     inc  R0
00A2 76FF             57                     mov @R0, #0xFF  ;4F
                      58                     
00A4 08               59                     inc  R0
00A5 7652             60                     mov @R0, #0x52  ;50
00A7 08               61                     inc  R0
00A8 7630             62                     mov @R0, #0x30  ;51
00AA 08               63                     inc  R0
00AB 7631             64                     mov @R0, #0x31  ;52
00AD 08               65                     inc  R0
00AE 7632             66                     mov @R0, #0x32  ;53
00B0 08               67                     inc  R0
00B1 7620             68                     mov @R0, #0x20  ;54
00B3 08               69                     inc  R0
00B4 763D             70                     mov @R0, #0x3D  ;55
00B6 08               71                     inc  R0
00B7 7620             72                     mov @R0, #0x20  ;56
00B9 08               73                     inc  R0
00BA 08               74                     inc  R0
00BB 08               75                     inc  R0
00BC 08               76                     inc  R0
00BD 08               77                     inc  R0
00BE 08               78                     inc  R0
00BF 08               79                     inc  R0
00C0 76FF             80                     mov @R0, #0xFF  ;5D
                      81             
00C2 08               82                     inc  R0
00C3 7652             83                     mov @R0, #0x52  ;5E
00C5 08               84                     inc  R0
00C6 7633             85                     mov @R0, #0x33  ;5F
00C8 08               86                     inc  R0
00C9 7634             87                     mov @R0, #0x34  ;60
00CB 08               88                     inc  R0
00CC 7635             89                     mov @R0, #0x35  ;61
00CE 08               90                     inc  R0
00CF 7620             91                     mov @R0, #0x20  ;62
00D1 08               92                     inc  R0
00D2 763D             93                     mov @R0, #0x3D  ;63
00D4 08               94                     inc  R0
00D5 7620             95                     mov @R0, #0x20  ;64
00D7 08               96                     inc  R0
00D8 08               97                     inc  R0
00D9 08               98                     inc  R0
00DA 08               99                     inc  R0
00DB 08              100                     inc  R0
00DC 08              101                     inc  R0
00DD 08              102                     inc  R0
00DE 76FF            103                     mov @R0, #0xFF  ;6B
                     104                     
00E0 08              105                     inc  R0
00E1 7652            106                     mov @R0, #0x52  ;6C
00E3 08              107                     inc  R0
00E4 7636            108                     mov @R0, #0x36  ;6D
00E6 08              109                     inc  R0
00E7 7637            110                     mov @R0, #0x37  ;6E
00E9 08              111                     inc  R0
00EA 7653            112                     mov @R0, #0x53  ;6F
00EC 08              113                     inc  R0
00ED 7650            114                     mov @R0, #0x50  ;70
00EF 08              115                     inc  R0
00F0 763D            116                     mov @R0, #0x3D  ;71
00F2 08              117                     inc  R0
A51 MACRO ASSEMBLER  LCDREGISTERDISPLAY                                                   09/24/2019 17:20:02 PAGE     3

00F3 7620            118                     mov @R0, #0x20  ;72
00F5 08              119                     inc  R0
00F6 08              120                     inc  R0
00F7 08              121                     inc  R0
00F8 08              122                     inc  R0
00F9 08              123                     inc  R0
00FA 08              124                     inc  R0
00FB 08              125                     inc  R0
00FC 76FF            126                     mov @R0, #0xFF  ;79
00FE 22              127     ret
00FF 8824            128     roll:   mov  0x24, R0                           ;MODIFY: R0, 0x11 to 0x30; 0x11 to 0x16 - S
                             HOW1, 0x19 to 0x1E - SHOW2, 0x21 to 0x26 - SHOW3, 0x29 to 0x2E - SHOW4
0101 8925            129                     mov  0x25, R1
0103 8A26            130                     mov  0x26, R2
0105 8D27            131                     mov  0x27, R5
0107 7821            132                     mov  R0, #0x21
0109 F6              133                     mov @R0, A              ;21
010A 08              134                     inc  R0
010B A6F0            135                     mov @R0, B              ;22
010D 08              136                     inc  R0
010E A6D0            137                     mov @R0, PSW    ;23
0110 08              138                     inc  R0
0111 7821            139                     mov  R0, #0x21
0113 7949            140                     mov  R1, #0x49
0115 1169            141                     acall bin2ascii
                     142                     
0117 7821            143                     mov  R0, #0x21
0119 A624            144                     mov @R0, 0x24
011B 08              145                     inc  R0
011C A625            146                     mov @R0, 0x25
011E 08              147                     inc  R0
011F E526            148                     mov  A,  0x26
0121 F6              149                     mov @R0, A
0122 08              150                     inc  R0
0123 7821            151                     mov  R0, #0x21
0125 7957            152                     mov  R1, #0x57
0127 1169            153                     acall bin2ascii
                     154                     
0129 7821            155                     mov  R0, #0x21
012B EB              156                     mov  A,  R3
012C F6              157                     mov @R0, A
012D 08              158                     inc  R0
012E EC              159                     mov  A,  R4
012F F6              160                     mov @R0, A
0130 08              161                     inc  R0
0131 A627            162                     mov @R0, 0x27
0133 08              163                     inc  R0
0134 7821            164                     mov  R0, #0x21
0136 7965            165                     mov  R1, #0x65
0138 1169            166                     acall bin2ascii
                     167                     
013A 7821            168                     mov  R0, #0x21
013C EE              169                     mov  A,  R6
013D F6              170                     mov @R0, A
013E 08              171                     inc  R0
013F EF              172                     mov  A,  R7
0140 F6              173                     mov @R0, A
0141 08              174                     inc  R0
0142 A681            175                     mov @R0, SP
0144 08              176                     inc  R0
0145 7821            177                     mov  R0, #0x21
0147 7973            178                     mov  R1, #0x73
0149 1169            179                     acall bin2ascii
014B 22              180     ret
                     181     
014C 75A000          182     main:   mov P2, #0x00                           ;MODIFY: DPTR, A, B, R1, R3, R7, P1, P2
A51 MACRO ASSEMBLER  LCDREGISTERDISPLAY                                                   09/24/2019 17:20:02 PAGE     4

014F 759000          183                     mov P1, #0x00
0152 7B00            184                     mov R3, #0x00
0154 1182            185                     acall desc
0156 31E0            186                     acall delay
0158 31E0            187                     acall delay
                     188                     
015A 3195            189                     acall lcd_init
015C 11FF            190     repeat: acall roll
015E 31E0            191                     acall delay
0160 31E0            192                     acall delay
0162 31E0            193                     acall delay
                     194                     
0164 7480            195                     mov   A,  #0x80
0166 31AF            196                     acall lcd_command
0168 31E0            197                     acall delay
016A 900064          198                     mov   dptr, #text
016D EB              199                     mov   A,  R3
016E 93              200                     movc  A, @A+dptr
016F 60DB            201                     jz    main
0171 F9              202                     mov   R1, A
0172 31CF            203                     acall lcd_sendstring
                     204                     
0174 0B              205                     inc R3
                     206                     
0175 74C0            207                     mov   A,  #0xC0
0177 31AF            208                     acall lcd_command
0179 31E0            209                     acall delay
017B 900064          210                     mov   dptr, #text
017E EB              211                     mov   A,  R3
017F 93              212                     movc  A, @A+dptr
0180 F9              213                     mov   R1, A
0181 31CF            214                     acall lcd_sendstring
                     215                     
0183 758AC8          216                     mov TL0, #0xC8
0186 75F032          217     CP4:    mov   B, #0x32
0189 31E0            218     CP5:    acall delay
018B D5F0FB          219                     djnz  B,  CP5
018E D58AF5          220                     djnz TL0, CP4
                     221                     
0191 0B              222                     inc   R3
0192 02015C          223                     ljmp  repeat
                     224     
0195                 225     lcd_init:                                                       ;MODIFY: DPTR, A, R7
0195 7F00            226                     mov   R7, #0x00
0197 900050          227                     mov   dptr, #initSeq
019A EF              228     CP1:    mov   A,  R7
019B 93              229                     movc  A,  @A+dptr
019C 0F              230                     inc   R7
019D F5A0            231                     mov   LCD_data, A
019F C280            232                     clr   LCD_rs
01A1 C281            233                     clr   LCD_rw
01A3 D282            234                     setb  LCD_en
01A5 31E0            235                     acall delay
01A7 C282            236                     clr   LCD_en
01A9 31E0            237                     acall delay
01AB BF04EC          238                     cjne  R7, #0x04, CP1
01AE 22              239     ret
                     240     
01AF                 241     lcd_command:                                            ;MODIFY: P0
01AF F5A0            242              mov   LCD_data, A
01B1 C280            243              clr   LCD_rs
01B3 C281            244              clr   LCD_rw
01B5 D282            245              setb  LCD_en
01B7 31E0            246                      acall delay
01B9 C282            247              clr   LCD_en
01BB 31E0            248                      acall delay
A51 MACRO ASSEMBLER  LCDREGISTERDISPLAY                                                   09/24/2019 17:20:02 PAGE     5

01BD 22              249     ret
                     250     
01BE                 251     lcd_senddata:                                           ;MODIFY: P0
01BE F5A0            252                     mov   LCD_data, A
01C0 D280            253                     setb  LCD_rs
01C2 C281            254                     clr   LCD_rw
01C4 D282            255                     setb  LCD_en
01C6 31E0            256                     acall delay
01C8 C282            257                     clr   LCD_en
01CA 31E0            258                     acall delay
01CC 31E0            259                     acall delay
01CE 22              260     ret
                     261     
01CF                 262     lcd_sendstring:                                         ;MODIFY: A, R1
01CF C0E0            263                     push  0x0E0
01D1                 264     lcd_sendstring_loop:
01D1 E7              265                     mov   A, @R1
01D2 B4FF03          266                     cjne  A, #0xFF, CP2
01D5 0201DD          267                     ljmp  exit
01D8 31BE            268     CP2:    acall lcd_senddata
01DA 09              269                     inc   R1
01DB 80F4            270                     sjmp  lcd_sendstring_loop
01DD D0E0            271     exit:   pop   0x0E0
01DF 22              272     ret
                     273     
01E0 C000            274     delay:  push 0                                          ;MODIFY: R5, R6
01E2 C001            275                     push 1
01E4 7D01            276                     mov  R5, #0x01
01E6 7EFF            277     loop2:  mov  R6, #0xFF
01E8 DEFE            278     loop1:  djnz R6, loop1
01EA DDFA            279                     djnz R5, loop2
01EC D001            280                     pop  1
01EE D000            281                     pop  0 
01F0 22              282     ret
                     283     
                     284     end
A51 MACRO ASSEMBLER  LCDREGISTERDISPLAY                                                   09/24/2019 17:20:02 PAGE     6

SYMBOL TABLE LISTING
------ ----- -------


N A M E              T Y P E  V A L U E   ATTRIBUTES

ASCII . . . . . . .  C ADDR   0054H   A   
B . . . . . . . . .  D ADDR   00F0H   A   
BIN2ASCII . . . . .  C ADDR   0069H   A   
CP1 . . . . . . . .  C ADDR   019AH   A   
CP2 . . . . . . . .  C ADDR   01D8H   A   
CP3 . . . . . . . .  C ADDR   006EH   A   
CP4 . . . . . . . .  C ADDR   0186H   A   
CP5 . . . . . . . .  C ADDR   0189H   A   
DELAY . . . . . . .  C ADDR   01E0H   A   
DESC. . . . . . . .  C ADDR   0082H   A   
EXIT. . . . . . . .  C ADDR   01DDH   A   
INITSEQ . . . . . .  C ADDR   0050H   A   
LCD_COMMAND . . . .  C ADDR   01AFH   A   
LCD_DATA. . . . . .  D ADDR   00A0H   A   
LCD_EN. . . . . . .  B ADDR   0080H.2 A   
LCD_INIT. . . . . .  C ADDR   0195H   A   
LCD_RS. . . . . . .  B ADDR   0080H.0 A   
LCD_RW. . . . . . .  B ADDR   0080H.1 A   
LCD_SENDDATA. . . .  C ADDR   01BEH   A   
LCD_SENDSTRING. . .  C ADDR   01CFH   A   
LCD_SENDSTRING_LOOP  C ADDR   01D1H   A   
LOOP1 . . . . . . .  C ADDR   01E8H   A   
LOOP2 . . . . . . .  C ADDR   01E6H   A   
MAIN. . . . . . . .  C ADDR   014CH   A   
P0. . . . . . . . .  D ADDR   0080H   A   
P1. . . . . . . . .  D ADDR   0090H   A   
P2. . . . . . . . .  D ADDR   00A0H   A   
PSW . . . . . . . .  D ADDR   00D0H   A   
REPEAT. . . . . . .  C ADDR   015CH   A   
ROLL. . . . . . . .  C ADDR   00FFH   A   
SP. . . . . . . . .  D ADDR   0081H   A   
TEXT. . . . . . . .  C ADDR   0064H   A   
TL0 . . . . . . . .  D ADDR   008AH   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
